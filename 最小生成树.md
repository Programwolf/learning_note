# 最小生成树MST（Minimum Spanning Tree）

## **定义**

图的生成树是它的一棵含有其所有顶点的无环连通子图。一幅加权图的最小生成树（MST）是它的一棵权值（树中所有边的权值之和）最小的生成树。

## **原理**

树的两个最重要的性质：
+ 用一条边连接树上的任意两个顶点都会产生一个新的环；
+ 从树中删去一条边会得到两棵独立的树。

### **切分定理**

定义：图的一种**切分**是将图的所有顶点分为两个非空的且不重叠的两个集合。**横切边**是一条连接两个属于不同集合的顶点的边。

**切分定理**：在一幅加权图中，给定任意的切分，它的横切边中的权重最小者必然属于图的最小生成树。

**证明**：今**e**为权重最小的横切边，**T**为图的最小生成树。我们采用反证法：假设**T**不包含**e**。那么如果将**e**加入**T**，得到的图必然含有一条经过**e**的环，且这个环至少含有一条横切边——设为**f**，**f**的权重必然大于**e**（因为**e**的权重是最小的且图中所有边的权重均不同）。那么我们删掉**f**而保留**e**就可以得到一棵权重更小的生成树。这和我们的假设**T**矛盾。

### **贪心算法**

**最小生成树的贪心算法**：下面这种方法会将含有*V*个顶点的任意加权连通图中属于最小生成树的边标记为黑色：初始状态下所有边均为灰色，找到一种切分，它产生的所有横切边均不为黑色。将他权重最小的横切边标记为黑色。反复，直到标记了*V-1*条边为止。

**证明**：为了简单，我们假设所有边的权重均不同，尽管没有这个假设该命题同样成立。根据切分定理，所有被标记为黑色的边均属于最小生成树。如果黑色边的数量小于*V-1*，必然还存在不会产生黑色横切边的切分（因为我们假设图是连通的）。只要找到了*V-1*条黑色的边，这些边所组成的就是一棵最小生成树。

